{"slots":{"0":{"name":"source","type":{"events":[],"methods":[]}},"1":{"name":"target","type":{"events":[],"methods":[]}},"2":{"name":"slot3","type":{"events":[],"methods":[]}},"3":{"name":"slot4","type":{"events":[],"methods":[]}},"4":{"name":"slot5","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-2":{"name":"system","type":{"events":[],"methods":[]}},"-3":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"-- Databank Duplicator\n-- connect a databank and name as \"source\"\n-- connect target databank with slot name \"target\"\n-- activate the board and follow instructions in lua channel\nfunction handleTextCommandInput(text)\n    \n    if text == \"confirm\" then\n        duplicate(true, false)\n    end \n    \n    if text == \"confirm overwrite\" then\n        duplicate(true, true)\n    end\n    \nend\n\nfunction duplicate(action, overwrite)\n    \n    if source == nil then\n        system.print(\"No source databank found\")\n        return false\n    end\n    \n    if target == nil then\n        system.print(\"No target databank found\")\n        return false\n    end\n\n    local sourceKeys = json.decode(source.getKeys())\n    local duplicateKeyCount = 0\n    \n    for k, v in pairs(sourceKeys) do\n\n        if target.hasKey(v) == 1 then \n            duplicateKeyCount = duplicateKeyCount + 1\n            if action and overwrite then\n                target.setStringValue(v, source.getStringValue(v))\n            end\n\t   else            \n            if action then\n                target.setStringValue(v, source.getStringValue(v))\n            end\n        end\n        \n    end\n    \n    if action == false then\n        system.print('..:: DU Databank Duplicator ::..')\n        system.print(source.getNbKeys() .. ' keys in source databank.')\n        system.print(target.getNbKeys() .. ' keys in target databank.')\n        system.print(duplicateKeyCount .. ' duplicate keys were found between the databanks.')\n        system.print(':: Actions - ')\n        system.print('Type \"confirm\" to copy the databank without overwriting existing keys ')\n        system.print('Type \"confirm overwrite to copy the databank, overwriting existing keys ')\n    else\n        system.print(':: Completed! ')\n        if overwrite then\n            system.print('The databank was copied and existing data was overwritten.')\n        else \n            system.print('The databank was copied and existing data was untouched.')\n        end\n    end\nend\n\nduplicate(false, false)\n","filter":{"args":[],"signature":"start()","slotKey":"-1"},"key":"0"},{"code":"handleTextCommandInput(text)","filter":{"args":[{"variable":"*"}],"signature":"inputText(text)","slotKey":"-2"},"key":"1"}],"methods":[],"events":[]}